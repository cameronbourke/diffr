angular.module("diffr",["ngAnimate","ui.router","diffr.controllers","diffr.filters","diffr.config","diffr.directives","diffr.services","infinite-scroll"]),function(){"use strict";function e(e,t){e.state("search",{url:"/search",templateUrl:"templates/search.html",controller:"SearchCtrl",controllerAs:"search"}).state("compare",{url:"/compare",templateUrl:"templates/compare.html",controller:"CompareCtrl",controllerAs:"compare"}),t.otherwise("/search")}angular.module("diffr.config",[]),angular.module("diffr.config").config(e),e.$inject=["$stateProvider","$urlRouterProvider"]}(),function(){"use strict";function e(e,t){}angular.module("diffr.controllers",[]),angular.module("diffr.controllers").controller("AppCtrl",e),e.$inject=["$scope","$rootScope"]}(),function(){"use strict";function e(e,t,r,o,c){function i(){var e=r.getObject("comparedUrls");s.comparedPhotosList=void 0!==e[0]?e:[]}function n(e){var t=r.getObject("comparedUrls"),o=t.indexOf(e);t.splice(o,1),s.comparedPhotosList=t,r.setObject("comparedUrls",t)}var s=this;s.removeComparedPhoto=n,i()}angular.module("diffr.controllers").controller("CompareCtrl",e),e.$inject=["$scope","$rootScope","LocalStorageService","FlickrService","StorageService"]}(),function(){"use strict";function e(e,t,r,o,c){function i(e,t){g||(h.searchedPhotos=e),h.searchedText=e,g=!1,h.searchedPhotosList=[],o.getSearchedPhotos(e,t).then(function(t){h.searchedPhotosList=t,-1===h.recentSearches.indexOf(e)&&h.recentSearches.push(e)})}function n(e,t){o.getSearchedPhotos(e,t).then(function(e){e.forEach(function(e){h.searchedPhotosList.push(e)})})}function s(e){i(e,20),h.showRecentsDropdown=!1}function a(){h.showRecentsDropdown=!h.showRecentsDropdown}function l(e){var t="https://farm"+e.farm+".staticflickr.com/"+e.server+"/"+e.id+"_"+e.secret+"_b.jpg";-1===p.indexOf(t)?(p.push(t),r.setObject("comparedUrls",p)):console.log("already in comparison list")}function f(){var e=r.getObject("comparedUrls");p=void 0!==e[0]?e:[]}function u(e){var t="https://farm"+e.farm+".staticflickr.com/"+e.server+"/"+e.id+"_"+e.secret+"_b.jpg";return-1===p.indexOf(t)?!0:!1}function d(){return"undefined"!=typeof r.getObject("comparedUrls")[0]?!0:!1}var h=this;h.modelOptions={updateOn:"default blur",debounce:{"default":1e3,blur:0}},h.recentSearches=[],h.showRecentsDropdown=!1,h.searchedText="selfie";var p,g=!0;h.getSearchedPhotos=i,h.updatePhotos=s,h.toggleRecents=a,h.loadMorePhotos=n,h.addPhotoToCompare=l,h.showCompareButton=u,h.hasComparedPhotos=d,i("selfie",20),f()}angular.module("diffr.controllers").controller("SearchCtrl",e),e.$inject=["$scope","$rootScope","LocalStorageService","FlickrService","StorageService"]}(),function(){"use strict";function e(){return{restrict:"E",template:['<svg class="icon-add-photos" width="100%" height="100%" viewBox="-1 -1 31 25" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">',"<title>Two photos stacked with an add icon in the corner</title>","<desc>Lets the user add a new photo to their list of compared images</desc>","<g class='svg-compare-icons'>","<g stroke-width='1'>","<path d='M0.118149935,4.50963844 L11.8374394,0.802704286 L18.1785857,17.7202619 L6.45929629,21.427196 L0.118149935,4.50963844 L0.118149935,4.50963844 Z'></path>","<path d='M18.0003708,0.243357633 L28.6245848,6.10760511 L18.5931005,21.44435 L7.96888653,15.5801025 L18.0003708,0.243357633 L18.0003708,0.243357633 Z'></path>","</g>","<g>",'<ellipse cx="5.54186573" cy="5.15083056" rx="5.54186573" ry="5.15083056"></ellipse>','<path d="M5.18820719,4.80797342 L5.18820719,2.40797342 L5.89552426,2.40797342 L5.89552426,4.80797342 L8.37113402,4.80797342 L8.37113402,5.49368771 L5.89552426,5.49368771',"L5.89552426,7.89368771",'L5.18820719,7.89368771 L5.18820719,5.49368771 L2.71259744,5.49368771 L2.71259744,4.80797342 L5.18820719,4.80797342 Z"></path>',"</g>","</g>","</svg>"].join("")}}angular.module("diffr.directives",[]),angular.module("diffr.directives").directive("iconAddCompare",e)}(),function(){"use strict";function e(){return function(e){return console.log(e),"undefined"!=typeof e?e.substring(0,1).toUpperCase()+e.substring(1):void 0}}angular.module("diffr.filters",[]),angular.module("diffr.filters").filter("capitalize",e)}(),function(){"use strict";function e(e,t){function r(r,c){var i=t.defer();return e.get("https://api.flickr.com/services/rest/?method=flickr.photos.search&api_key="+o+"&tags="+r+"&per_page="+c+"&format=json&nojsoncallback=1").success(function(e){i.resolve(e.photos.photo)}).error(function(e,t){console.log(e),i.reject(e)}),i.promise}var o="52ebcfc572066983269bf5140708086d";this.getSearchedPhotos=r}angular.module("diffr.services",[]),angular.module("diffr.services").service("FlickrService",e),e.$inject=["$http","$q"]}(),function(){"use strict";function e(e){function t(t,r){e.localStorage[t]=r}function r(t,r){return e.localStorage[t]||r}function o(t,r){e.localStorage[t]=JSON.stringify(r)}function c(t){return JSON.parse(e.localStorage[t]||"{}")}this.set=t,this.get=r,this.setObject=o,this.getObject=c}angular.module("diffr.services").service("LocalStorageService",e),e.$inject=["$window"]}(),function(){"use strict";function e(){function e(e,t){s.objects[e]=t}function t(e){return s.objects[e]}function r(e,t){s.arrays[e]=t}function o(e){return s.arrays[e]}function c(e,t){s.strings[e]=t}function i(e){return s.strings[e]}function n(){return s}var s={};s.objects={},s.arrays={},s.strings={},this.setObject=e,this.getObject=t,this.setArray=r,this.getArray=o,this.setString=c,this.getString=i,this.getAllStorage=n}angular.module("diffr.services").service("StorageService",e),e.$inject=[]}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsInJvdXRlLmNvbmZpZy5qcyIsImN0cmxzL2FwcC5jb250cm9sbGVyLmpzIiwiY3RybHMvY29tcGFyZS5jb250cm9sbGVyLmpzIiwiY3RybHMvc2VhcmNoLmNvbnRyb2xsZXIuanMiLCJkaXJlY3RpdmVzL2RpcmVjdGl2ZXMuanMiLCJmaWx0ZXJzL2ZpbHRlcnMuanMiLCJzZXJ2aWNlcy9mbGlja3Iuc2VydmljZS5qcyIsInNlcnZpY2VzL2xvY2FsU3RvcmFnZS5zZXJ2aWNlLmpzIiwic2VydmljZXMvc3RvcmFnZS5zZXJ2aWNlLmpzIl0sIm5hbWVzIjpbImFuZ3VsYXIiLCJtb2R1bGUiLCJyb3V0ZUNvbmZpZyIsIiRzdGF0ZVByb3ZpZGVyIiwiJHVybFJvdXRlclByb3ZpZGVyIiwic3RhdGUiLCJ1cmwiLCJ0ZW1wbGF0ZVVybCIsImNvbnRyb2xsZXIiLCJjb250cm9sbGVyQXMiLCJvdGhlcndpc2UiLCJjb25maWciLCIkaW5qZWN0IiwiQXBwQ3RybCIsIiRzY29wZSIsIiRyb290U2NvcGUiLCJDb21wYXJlQ3RybCIsIkxvY2FsU3RvcmFnZVNlcnZpY2UiLCJGbGlja3JTZXJ2aWNlIiwiU3RvcmFnZVNlcnZpY2UiLCJnZXRDb21wYXJlZFBob3Rvc0xpc3QiLCJjb21wYXJlVXJscyIsImdldE9iamVjdCIsImNvbXBhcmUiLCJjb21wYXJlZFBob3Rvc0xpc3QiLCJ1bmRlZmluZWQiLCJyZW1vdmVDb21wYXJlZFBob3RvIiwiY29tcGFyZUFyciIsInVybEluZGV4IiwiaW5kZXhPZiIsInNwbGljZSIsInNldE9iamVjdCIsInRoaXMiLCJTZWFyY2hDdHJsIiwiZ2V0U2VhcmNoZWRQaG90b3MiLCJ0ZXh0IiwiYW1vdW50IiwiaW5pdGlhbExvYWQiLCJzZWFyY2giLCJzZWFyY2hlZFBob3RvcyIsInNlYXJjaGVkVGV4dCIsInNlYXJjaGVkUGhvdG9zTGlzdCIsInRoZW4iLCJwaG90b3MiLCJyZWNlbnRTZWFyY2hlcyIsInB1c2giLCJsb2FkTW9yZVBob3RvcyIsImZvckVhY2giLCJlbGVtZW50IiwidXBkYXRlUGhvdG9zIiwibmV3VmFsdWUiLCJzaG93UmVjZW50c0Ryb3Bkb3duIiwidG9nZ2xlUmVjZW50cyIsImFkZFBob3RvVG9Db21wYXJlIiwicGhvdG8iLCJmYXJtIiwic2VydmVyIiwiaWQiLCJzZWNyZXQiLCJuZXdBcnJheSIsImNvbnNvbGUiLCJsb2ciLCJzaG93Q29tcGFyZUJ1dHRvbiIsImhhc0NvbXBhcmVkUGhvdG9zIiwibW9kZWxPcHRpb25zIiwidXBkYXRlT24iLCJkZWJvdW5jZSIsImRlZmF1bHQiLCJibHVyIiwiaWNvbkFkZENvbXBhcmUiLCJyZXN0cmljdCIsInRlbXBsYXRlIiwiam9pbiIsImRpcmVjdGl2ZSIsImNhcGl0YWxpemUiLCJpbnB1dCIsInN1YnN0cmluZyIsInRvVXBwZXJDYXNlIiwiZmlsdGVyIiwiJGh0dHAiLCIkcSIsImRlZmVyIiwiZ2V0IiwiZmxpY2tyS2V5Iiwic3VjY2VzcyIsImRhdGEiLCJyZXNvbHZlIiwiZXJyb3IiLCJzdGF0dXMiLCJyZWplY3QiLCJwcm9taXNlIiwic2VydmljZSIsIiR3aW5kb3ciLCJzZXQiLCJrZXkiLCJ2YWx1ZSIsImxvY2FsU3RvcmFnZSIsImRlZmF1bHRWYWx1ZSIsIkpTT04iLCJzdHJpbmdpZnkiLCJwYXJzZSIsInN0b3JhZ2VPYmplY3QiLCJvYmplY3RzIiwic2V0QXJyYXkiLCJhcnJheXMiLCJnZXRBcnJheSIsInNldFN0cmluZyIsInN0cmluZ3MiLCJnZXRTdHJpbmciLCJnZXRBbGxTdG9yYWdlIl0sIm1hcHBpbmdzIjoiQUFBQUEsUUFBQUMsT0FBQSxTQUNBLFlBQ0EsWUFDQSxvQkFDQSxnQkFDQSxlQUNBLG1CQUNBLGlCQUNBLG9CQ1JBLFdBQ0EsWUFRQSxTQUFBQyxHQUFBQyxFQUFBQyxHQU1BRCxFQUVBRSxNQUFBLFVBQ0FDLElBQUEsVUFDQUMsWUFBQSx3QkFDQUMsV0FBQSxhQUNBQyxhQUFBLFdBR0FKLE1BQUEsV0FDQUMsSUFBQSxXQUNBQyxZQUFBLHlCQUNBQyxX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ZSI6ImRpZmZyLmFwcC5qcyIsInNvdXJjZXNDb250ZW50IjpbImFuZ3VsYXIubW9kdWxlKCdkaWZmcicsIFtcbiAgJ25nQW5pbWF0ZScsXG4gICd1aS5yb3V0ZXInLFxuICAnZGlmZnIuY29udHJvbGxlcnMnLFxuICAnZGlmZnIuZmlsdGVycycsXG4gICdkaWZmci5jb25maWcnLFxuICAnZGlmZnIuZGlyZWN0aXZlcycsXG4gICdkaWZmci5zZXJ2aWNlcycsXG4gICdpbmZpbml0ZS1zY3JvbGwnXG5dKTtcbiIsIihmdW5jdGlvbigpe1xuICAndXNlIHN0cmljdCc7XG5cbiAgYW5ndWxhci5tb2R1bGUoJ2RpZmZyLmNvbmZpZycsIFtdKTtcblxuICBhbmd1bGFyLm1vZHVsZSgnZGlmZnIuY29uZmlnJykuY29uZmlnKHJvdXRlQ29uZmlnKTtcblxuICByb3V0ZUNvbmZpZy4kaW5qZWN0ID0gWyckc3RhdGVQcm92aWRlcicsICckdXJsUm91dGVyUHJvdmlkZXInXTtcblxuICBmdW5jdGlvbiByb3V0ZUNvbmZpZygkc3RhdGVQcm92aWRlciwgJHVybFJvdXRlclByb3ZpZGVyKSB7XG5cbiAgLy8gSW9uaWMgdXNlcyBBbmd1bGFyVUkgUm91dGVyIHdoaWNoIHVzZXMgdGhlIGNvbmNlcHQgb2Ygc3RhdGVzXG4gIC8vIExlYXJuIG1vcmUgaGVyZTogaHR0cHM6Ly9naXRodWIuY29tL2FuZ3VsYXItdWkvdWktcm91dGVyXG4gIC8vIFNldCB1cCB0aGUgdmFyaW91cyBzdGF0ZXMgd2hpY2ggdGhlIGFwcCBjYW4gYmUgaW4uXG4gIC8vIEVhY2ggc3RhdGUncyBjb250cm9sbGVyIGNhbiBiZSBmb3VuZCBpbiBjb250cm9sbGVycy5qc1xuICAkc3RhdGVQcm92aWRlclxuXG4gIC5zdGF0ZSgnc2VhcmNoJywge1xuICAgIHVybDogXCIvc2VhcmNoXCIsXG4gICAgdGVtcGxhdGVVcmw6IFwidGVtcGxhdGVzL3NlYXJjaC5odG1sXCIsXG4gICAgY29udHJvbGxlcjogXCJTZWFyY2hDdHJsXCIsXG4gICAgY29udHJvbGxlckFzOiBcInNlYXJjaFwiLFxuICB9KVxuXG4gIC5zdGF0ZSgnY29tcGFyZScsIHtcbiAgICB1cmw6IFwiL2NvbXBhcmVcIixcbiAgICB0ZW1wbGF0ZVVybDogXCJ0ZW1wbGF0ZXMvY29tcGFyZS5odG1sXCIsXG4gICAgY29udHJvbGxlcjogXCJDb21wYXJlQ3RybFwiLFxuICAgIGNvbnRyb2xsZXJBczogXCJjb21wYXJlXCIsXG4gIH0pO1xuXG4gIC8vIGlmIG5vbmUgb2YgdGhlIGFib3ZlIHN0YXRlcyBhcmUgbWF0Y2hlZCwgdXNlIHRoaXMgYXMgdGhlIGZhbGxiYWNrXG4gICR1cmxSb3V0ZXJQcm92aWRlci5vdGhlcndpc2UoJy9zZWFyY2gnKTtcbn1cblxufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGFuZ3VsYXIubW9kdWxlKCdkaWZmci5jb250cm9sbGVycycsIFtdKTtcblxuICBhbmd1bGFyLm1vZHVsZSgnZGlmZnIuY29udHJvbGxlcnMnKS5jb250cm9sbGVyKCdBcHBDdHJsJywgQXBwQ3RybCk7XG5cbiAgQXBwQ3RybC4kaW5qZWN0ID0gWyckc2NvcGUnLCAnJHJvb3RTY29wZSddO1xuXG4gIGZ1bmN0aW9uIEFwcEN0cmwoJHNjb3BlLCAkcm9vdFNjb3BlKSB7XG4gICAgdmFyIGFwcCA9IHRoaXM7XG5cbiAgICAvLyB2YXJpYWJsZXNcblxuICAgIC8vIG1ldGhvZHNcblxuICAgIC8vIGluaXRpYXRvcnNcblxuXG4gIH1cblxufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGFuZ3VsYXIubW9kdWxlKCdkaWZmci5jb250cm9sbGVycycpLmNvbnRyb2xsZXIoJ0NvbXBhcmVDdHJsJywgQ29tcGFyZUN0cmwpO1xuXG4gIENvbXBhcmVDdHJsLiRpbmplY3QgPSBbJyRzY29wZScsICckcm9vdFNjb3BlJywgJ0xvY2FsU3RvcmFnZVNlcnZpY2UnLCAnRmxpY2tyU2VydmljZScsICdTdG9yYWdlU2VydmljZSddO1xuXG4gIGZ1bmN0aW9uIENvbXBhcmVDdHJsKCRzY29wZSwgJHJvb3RTY29wZSwgTG9jYWxTdG9yYWdlU2VydmljZSwgRmxpY2tyU2VydmljZSwgU3RvcmFnZVNlcnZpY2UpIHtcbiAgICB2YXIgY29tcGFyZSA9IHRoaXM7XG5cbiAgICAvLyB2YXJpYWJsZXNcblxuICAgIC8vIG1ldGhvZHNcbiAgICBjb21wYXJlLnJlbW92ZUNvbXBhcmVkUGhvdG8gPSByZW1vdmVDb21wYXJlZFBob3RvO1xuXG4gICAgLy8gaW5pdGlhdG9yc1xuICAgIGdldENvbXBhcmVkUGhvdG9zTGlzdCgpO1xuXG5cblxuICAgIGZ1bmN0aW9uIGdldENvbXBhcmVkUGhvdG9zTGlzdCgpIHtcbiAgICAgIC8vIG5lZWQgdG8ga25vdyB3aGV0aGVyIHRoZSB1c2VyIGhhcyBwaG90b3Mgc2F2ZWQgb3Igbm90XG4gICAgICB2YXIgY29tcGFyZVVybHMgPSBMb2NhbFN0b3JhZ2VTZXJ2aWNlLmdldE9iamVjdCgnY29tcGFyZWRVcmxzJyk7XG4gICAgICBpZihjb21wYXJlVXJsc1swXSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIGNvbXBhcmUuY29tcGFyZWRQaG90b3NMaXN0ID0gY29tcGFyZVVybHM7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb21wYXJlLmNvbXBhcmVkUGhvdG9zTGlzdCA9IFtdO1xuICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIHJlbW92ZUNvbXBhcmVkUGhvdG8odXJsKSB7XG4gICAgICB2YXIgY29tcGFyZUFyciA9IExvY2FsU3RvcmFnZVNlcnZpY2UuZ2V0T2JqZWN0KCdjb21wYXJlZFVybHMnKSxcbiAgICAgIHVybEluZGV4ICAgICAgID0gY29tcGFyZUFyci5pbmRleE9mKHVybCk7XG4gICAgICBjb21wYXJlQXJyLnNwbGljZSh1cmxJbmRleCwgMSk7XG4gICAgICBjb21wYXJlLmNvbXBhcmVkUGhvdG9zTGlzdCA9IGNvbXBhcmVBcnI7XG4gICAgICAvLyBtYWtlIHN1cmUgdG8gdXBkYXRlIExvY2FsU3RvcmFnZSBhZnRlciB3ZSd2ZSBhc3NpZ25lZCB0aGUgbmV3IGFycmF5IHRvIHNjb3BlXG4gICAgICBMb2NhbFN0b3JhZ2VTZXJ2aWNlLnNldE9iamVjdCgnY29tcGFyZWRVcmxzJywgY29tcGFyZUFycik7XG4gICAgfVxuXG4gIH1cblxufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGFuZ3VsYXIubW9kdWxlKCdkaWZmci5jb250cm9sbGVycycpLmNvbnRyb2xsZXIoJ1NlYXJjaEN0cmwnLCBTZWFyY2hDdHJsKTtcblxuICBTZWFyY2hDdHJsLiRpbmplY3QgPSBbJyRzY29wZScsICckcm9vdFNjb3BlJywgJ0xvY2FsU3RvcmFnZVNlcnZpY2UnLCAnRmxpY2tyU2VydmljZScsICdTdG9yYWdlU2VydmljZSddO1xuXG4gIGZ1bmN0aW9uIFNlYXJjaEN0cmwoJHNjb3BlLCAkcm9vdFNjb3BlLCBMb2NhbFN0b3JhZ2VTZXJ2aWNlLCBGbGlja3JTZXJ2aWNlLCBTdG9yYWdlU2VydmljZSkge1xuICAgIHZhciBzZWFyY2ggPSB0aGlzO1xuXG4gICAgLy8gdmFyaWFibGVzXG4gICAgc2VhcmNoLm1vZGVsT3B0aW9ucyA9IHtcbiAgICAgIC8vIG5lZWQgdG8gZGVib3VuY2UgdGhlIG1vZGVsIGZyb20gdXBkYXRpbmdcbiAgICAgIC8vIHNvIGl0IG9ubHkgZ29lcyB0byBmbGlja3IgYXBpIHdoZW4gdGhlIHVzZXJcbiAgICAgIC8vIGlzIHN1cmUgYWJvdXQgd2hhdCB0aGV5IGFyZSBzZWFyY2hpbmcgZm9yXG4gICAgICB1cGRhdGVPbjogJ2RlZmF1bHQgYmx1cicsXG4gICAgICBkZWJvdW5jZToge1xuICAgICAgICAnZGVmYXVsdCc6IDEgKiAxMDAwLFxuICAgICAgICAnYmx1cic6IDBcbiAgICAgIH1cbiAgICB9O1xuICAgIHNlYXJjaC5yZWNlbnRTZWFyY2hlcyAgICAgID0gW107XG4gICAgc2VhcmNoLnNob3dSZWNlbnRzRHJvcGRvd24gPSBmYWxzZTtcbiAgICBzZWFyY2guc2VhcmNoZWRUZXh0ICAgICAgICA9ICdzZWxmaWUnO1xuICAgIHZhciBpbml0aWFsTG9hZCAgICAgICAgICAgID0gdHJ1ZTtcbiAgICB2YXIgbmV3QXJyYXk7XG5cbiAgICAvLyBtZXRob2RzXG4gICAgc2VhcmNoLmdldFNlYXJjaGVkUGhvdG9zID0gZ2V0U2VhcmNoZWRQaG90b3M7XG4gICAgc2VhcmNoLnVwZGF0ZVBob3RvcyAgICAgID0gdXBkYXRlUGhvdG9zO1xuICAgIHNlYXJjaC50b2dnbGVSZWNlbnRzICAgICA9IHRvZ2dsZVJlY2VudHM7XG4gICAgc2VhcmNoLmxvYWRNb3JlUGhvdG9zICAgID0gbG9hZE1vcmVQaG90b3M7XG4gICAgc2VhcmNoLmFkZFBob3RvVG9Db21wYXJlID0gYWRkUGhvdG9Ub0NvbXBhcmU7XG4gICAgc2VhcmNoLnNob3dDb21wYXJlQnV0dG9uID0gc2hvd0NvbXBhcmVCdXR0b247XG4gICAgc2VhcmNoLmhhc0NvbXBhcmVkUGhvdG9zID0gaGFzQ29tcGFyZWRQaG90b3M7XG5cbiAgICAvLyBpbml0aWF0b3JzXG4gICAgLy8gaW5pdGlhbGx5IGxvYWRpbmcgMjAgcGhvdG9zIHdpdGggdGhlIHRhZyBzZWxmaWVcbiAgICBnZXRTZWFyY2hlZFBob3Rvcygnc2VsZmllJywgMjApO1xuICAgIGdldENvbXBhcmVkUGhvdG9zTGlzdCgpO1xuXG5cblxuICAgIGZ1bmN0aW9uIGdldFNlYXJjaGVkUGhvdG9zKHRleHQsIGFtb3VudCkge1xuICAgICAgaWYoIWluaXRpYWxMb2FkKSB7XG4gICAgICAgIHNlYXJjaC5zZWFyY2hlZFBob3RvcyA9IHRleHQ7XG4gICAgICB9XG4gICAgICBzZWFyY2guc2VhcmNoZWRUZXh0ID0gdGV4dDtcbiAgICAgIGluaXRpYWxMb2FkID0gZmFsc2U7XG4gICAgICBzZWFyY2guc2VhcmNoZWRQaG90b3NMaXN0ID0gW107XG4gICAgICBGbGlja3JTZXJ2aWNlLmdldFNlYXJjaGVkUGhvdG9zKHRleHQsIGFtb3VudCkudGhlbihmdW5jdGlvbihwaG90b3MpIHtcbiAgICAgICAgc2VhcmNoLnNlYXJjaGVkUGhvdG9zTGlzdCA9IHBob3RvcztcbiAgICAgICAgLy8gZG9udHQgd2FudCBkdXBsaWNhdGVzIGluIHRoZSBuZy1yZXBlYXQgZm9yIHJlY2VudCBzZWFyY2hlc1xuICAgICAgICBpZihzZWFyY2gucmVjZW50U2VhcmNoZXMuaW5kZXhPZih0ZXh0KSA9PT0gLTEpIHtcbiAgICAgICAgICBzZWFyY2gucmVjZW50U2VhcmNoZXMucHVzaCh0ZXh0KTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gbG9hZE1vcmVQaG90b3ModGV4dCwgYW1vdW50KSB7XG4gICAgICBGbGlja3JTZXJ2aWNlLmdldFNlYXJjaGVkUGhvdG9zKHRleHQsIGFtb3VudCkudGhlbihmdW5jdGlvbihwaG90b3MpIHtcbiAgICAgICAgLy8gbmVlZCB0byBhZGQgZWFjaCBwaG90byB0byB0aGUgZW5kIG9mIHRoZSBzZWFyY2hlZFBob3Rvc0xpc3QgYXJyYXlcbiAgICAgICAgcGhvdG9zLmZvckVhY2goZnVuY3Rpb24oZWxlbWVudCkge1xuICAgICAgICAgIHNlYXJjaC5zZWFyY2hlZFBob3Rvc0xpc3QucHVzaChlbGVtZW50KTtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiB1cGRhdGVQaG90b3MobmV3VmFsdWUpIHtcbiAgICAgIC8vIGRvbid0IHVwZGF0ZSB0aGUgcGhvdG9zIHdoZW4gdGhlIHNlYXJjaCBiYXIgaXMgZW1wdHlcbiAgICAgIGlmKG5ld1ZhbHVlICE9PSAnJyB8fCB0eXBlb2YgbmV3VmFsdWUgIT09ICd1bmRlZmluZWQnIHx8ICFmYWxzZSkge1xuICAgICAgICBnZXRTZWFyY2hlZFBob3RvcyhuZXdWYWx1ZSwgMjApO1xuICAgICAgICBzZWFyY2guc2hvd1JlY2VudHNEcm9wZG93biA9IGZhbHNlO1xuICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIHRvZ2dsZVJlY2VudHMoKSB7XG4gICAgICBzZWFyY2guc2hvd1JlY2VudHNEcm9wZG93biA9ICFzZWFyY2guc2hvd1JlY2VudHNEcm9wZG93bjtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBhZGRQaG90b1RvQ29tcGFyZShwaG90bykge1xuICAgICAgLy8gbmVlZCB0byBjb25zdHJ1Y3QgdGhlIHVuaXF1ZSB1cmwgZm9yIHRoZSBwaG90b1xuICAgICAgdmFyIHVybCA9ICdodHRwczovL2Zhcm0nICsgcGhvdG8uZmFybSArICcuc3RhdGljZmxpY2tyLmNvbS8nICsgcGhvdG8uc2VydmVyICsgJy8nICsgcGhvdG8uaWQgKyAnXycgKyBwaG90by5zZWNyZXQgKyAnX2IuanBnJztcbiAgICAgIGlmKG5ld0FycmF5LmluZGV4T2YodXJsKSA9PT0gLTEpIHtcbiAgICAgICAgbmV3QXJyYXkucHVzaCh1cmwpO1xuICAgICAgICBMb2NhbFN0b3JhZ2VTZXJ2aWNlLnNldE9iamVjdCgnY29tcGFyZWRVcmxzJywgbmV3QXJyYXkpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29uc29sZS5sb2coJ2FscmVhZHkgaW4gY29tcGFyaXNvbiBsaXN0Jyk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZ2V0Q29tcGFyZWRQaG90b3NMaXN0KCkge1xuICAgICAgdmFyIGNvbXBhcmVVcmxzID0gTG9jYWxTdG9yYWdlU2VydmljZS5nZXRPYmplY3QoJ2NvbXBhcmVkVXJscycpO1xuICAgICAgaWYoY29tcGFyZVVybHNbMF0gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICBuZXdBcnJheSA9IGNvbXBhcmVVcmxzO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgbmV3QXJyYXkgPSBbXTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzaG93Q29tcGFyZUJ1dHRvbihwaG90bykge1xuICAgICAgdmFyIHVybCA9ICdodHRwczovL2Zhcm0nICsgcGhvdG8uZmFybSArICcuc3RhdGljZmxpY2tyLmNvbS8nICsgcGhvdG8uc2VydmVyICsgJy8nICsgcGhvdG8uaWQgKyAnXycgKyBwaG90by5zZWNyZXQgKyAnX2IuanBnJztcbiAgICAgIC8vIGlmIHRoZSBwaG90byBpcyBhbHJlYWR5IHNhdmVkLCBkb24ndCBzaG93IHRoZSBhZGQgdG8gY29tcGFyZSBidG5cbiAgICAgIGlmKG5ld0FycmF5LmluZGV4T2YodXJsKSA9PT0gLTEpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gaGFzQ29tcGFyZWRQaG90b3MoKSB7XG4gICAgICAvLyBvbmx5IHB1bHNlIHRoZSBjb21wYXJlIHBob3RvcyBuYXYgYnV0dG9uIGlmIHRoZXJlIGFyZSBwaG90b3Mgc2F2ZWRcbiAgICAgIGlmKHR5cGVvZiBMb2NhbFN0b3JhZ2VTZXJ2aWNlLmdldE9iamVjdCgnY29tcGFyZWRVcmxzJylbMF0gIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgIH1cblxuICB9XG5cbn0pKCk7XG4iLCIoZnVuY3Rpb24oKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICBhbmd1bGFyLm1vZHVsZSgnZGlmZnIuZGlyZWN0aXZlcycsIFtdKTtcblxuICAvLyBhbGxvd3MgdXMgdG8gdXNlIHRoZSBiZW5lZml0cyBvZiBpbmxpbmUgc3ZnLCB3aXRob3V0IHRoZSBjbHV0dGVyIG9mIHRoZSBtYXJrdXAgaW4gb3VyIGh0bWxcbiAgZnVuY3Rpb24gaWNvbkFkZENvbXBhcmUoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICB0ZW1wbGF0ZTogW1xuICAgICAgJzxzdmcgY2xhc3M9XCJpY29uLWFkZC1waG90b3NcIiB3aWR0aD1cIjEwMCVcIiBoZWlnaHQ9XCIxMDAlXCIgdmlld0JveD1cIi0xIC0xIDMxIDI1XCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHhtbG5zOnhsaW5rPVwiaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGlua1wiPicsXG4gICAgICAgIFwiPHRpdGxlPlR3byBwaG90b3Mgc3RhY2tlZCB3aXRoIGFuIGFkZCBpY29uIGluIHRoZSBjb3JuZXI8L3RpdGxlPlwiLFxuICAgICAgICBcIjxkZXNjPkxldHMgdGhlIHVzZXIgYWRkIGEgbmV3IHBob3RvIHRvIHRoZWlyIGxpc3Qgb2YgY29tcGFyZWQgaW1hZ2VzPC9kZXNjPlwiLFxuICAgICAgICAvLyB0YXJnZXQgdGhpcyBjbGFzcyB0byBjaGFuZ2UgZmlsbCwgc3Ryb2tlIGNvbG91ciBldGMgaW4gdGhlIGNzc1xuICAgICAgICBcIjxnIGNsYXNzPSdzdmctY29tcGFyZS1pY29ucyc+XCIsXG4gICAgICAgICAgXCI8ZyBzdHJva2Utd2lkdGg9JzEnPlwiLFxuICAgICAgICAgICAgXCI8cGF0aCBkPSdNMC4xMTgxNDk5MzUsNC41MDk2Mzg0NCBMMTEuODM3NDM5NCwwLjgwMjcwNDI4NiBMMTguMTc4NTg1NywxNy43MjAyNjE5IEw2LjQ1OTI5NjI5LDIxLjQyNzE5NiBMMC4xMTgxNDk5MzUsNC41MDk2Mzg0NCBMMC4xMTgxNDk5MzUsNC41MDk2Mzg0NCBaJz48L3BhdGg+XCIsXG4gICAgICAgICAgICBcIjxwYXRoIGQ9J00xOC4wMDAzNzA4LDAuMjQzMzU3NjMzIEwyOC42MjQ1ODQ4LDYuMTA3NjA1MTEgTDE4LjU5MzEwMDUsMjEuNDQ0MzUgTDcuOTY4ODg2NTMsMTUuNTgwMTAyNSBMMTguMDAwMzcwOCwwLjI0MzM1NzYzMyBMMTguMDAwMzcwOCwwLjI0MzM1NzYzMyBaJz48L3BhdGg+XCIsXG4gICAgICAgICAgXCI8L2c+XCIsXG4gICAgICAgICAgXCI8Zz5cIixcbiAgICAgICAgICAgICc8ZWxsaXBzZSBjeD1cIjUuNTQxODY1NzNcIiBjeT1cIjUuMTUwODMwNTZcIiByeD1cIjUuNTQxODY1NzNcIiByeT1cIjUuMTUwODMwNTZcIj48L2VsbGlwc2U+JyxcbiAgICAgICAgICAgICc8cGF0aCBkPVwiTTUuMTg4MjA3MTksNC44MDc5NzM0MiBMNS4xODgyMDcxOSwyLjQwNzk3MzQyIEw1Ljg5NTUyNDI2LDIuNDA3OTczNDIgTDUuODk1NTI0MjYsNC44MDc5NzM0MiBMOC4zNzExMzQwMiw0LjgwNzk3MzQyIEw4LjM3MTEzNDAyLDUuNDkzNjg3NzEgTDUuODk1NTI0MjYsNS40OTM2ODc3MScsICdMNS44OTU1MjQyNiw3Ljg5MzY4NzcxJywgJ0w1LjE4ODIwNzE5LDcuODkzNjg3NzEgTDUuMTg4MjA3MTksNS40OTM2ODc3MSBMMi43MTI1OTc0NCw1LjQ5MzY4NzcxIEwyLjcxMjU5NzQ0LDQuODA3OTczNDIgTDUuMTg4MjA3MTksNC44MDc5NzM0MiBaXCI+PC9wYXRoPicsXG4gICAgICAgICAgJzwvZz4nLFxuICAgICAgICAnPC9nPicsXG4gICAgICAnPC9zdmc+J1xuICAgICAgXS5qb2luKCcnKVxuICAgIH07XG4gIH1cblxuICBhbmd1bGFyXG4gIC5tb2R1bGUoJ2RpZmZyLmRpcmVjdGl2ZXMnKVxuICAuZGlyZWN0aXZlKCdpY29uQWRkQ29tcGFyZScsIGljb25BZGRDb21wYXJlKTtcblxufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGFuZ3VsYXIubW9kdWxlKCdkaWZmci5maWx0ZXJzJywgW10pO1xuXG4gIGZ1bmN0aW9uIGNhcGl0YWxpemUoKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKGlucHV0KSB7XG4gICAgICBjb25zb2xlLmxvZyhpbnB1dCk7XG4gICAgICBpZih0eXBlb2YgaW5wdXQgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgIHJldHVybiBpbnB1dC5zdWJzdHJpbmcoMCwxKS50b1VwcGVyQ2FzZSgpICsgaW5wdXQuc3Vic3RyaW5nKDEpO1xuICAgICAgfVxuICAgIH07XG4gIH1cblxuICBhbmd1bGFyXG4gICAgLm1vZHVsZSgnZGlmZnIuZmlsdGVycycpXG4gICAgLmZpbHRlcignY2FwaXRhbGl6ZScsIGNhcGl0YWxpemUpO1xuXG59KSgpO1xuIiwiKGZ1bmN0aW9uKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgYW5ndWxhci5tb2R1bGUoJ2RpZmZyLnNlcnZpY2VzJywgW10pO1xuXG4gIGFuZ3VsYXIubW9kdWxlKCdkaWZmci5zZXJ2aWNlcycpLnNlcnZpY2UoJ0ZsaWNrclNlcnZpY2UnLCBGbGlja3JTZXJ2aWNlKTtcblxuICAvLyBuZWVkIHRoZSBpbmplY3QgbWV0aG9kIGZvciBtaW5pZmljYXRpb25cbiAgRmxpY2tyU2VydmljZS4kaW5qZWN0ID0gWyckaHR0cCcsICckcSddO1xuXG4gIGZ1bmN0aW9uIEZsaWNrclNlcnZpY2UoJGh0dHAsICRxKSB7XG5cbiAgICAvLyB2YXJpYWJsZXNcbiAgICB2YXIgZmxpY2tyS2V5ID0gJzUyZWJjZmM1NzIwNjY5ODMyNjliZjUxNDA3MDgwODZkJyxcbiAgICBmbGlja3JTZWNyZXQgID0gJ2U4ZDUzYTJmZjcwYjEwNzcnO1xuXG4gICAgLy8gbWV0aG9kc1xuICAgIHRoaXMuZ2V0U2VhcmNoZWRQaG90b3MgPSBnZXRTZWFyY2hlZFBob3RvcztcblxuICAgIC8vIGluaXRpYXRvcnNcblxuXG5cbiAgICBmdW5jdGlvbiBnZXRTZWFyY2hlZFBob3Rvcyh0ZXh0LCBhbW91bnQpIHtcbiAgICAgIC8vIG5lZWQgdG8gdXNlIGEgcHJvbWlzZSBiZWN1YXNlICRodHRwJ3Mgc3VjY2VzcyBhbmQgZXJyb3IgY2FuIGJlIHVucmVsaWFibGVcbiAgICAgIHZhciBkZWZlciA9ICRxLmRlZmVyKCk7XG5cbiAgICAgICRodHRwLmdldCgnaHR0cHM6Ly9hcGkuZmxpY2tyLmNvbS9zZXJ2aWNlcy9yZXN0Lz9tZXRob2Q9ZmxpY2tyLnBob3Rvcy5zZWFyY2gmYXBpX2tleT0nICsgZmxpY2tyS2V5ICsgJyZ0YWdzPScgKyB0ZXh0ICsgJyZwZXJfcGFnZT0nICsgYW1vdW50ICsgJyZmb3JtYXQ9anNvbiZub2pzb25jYWxsYmFjaz0xJylcbiAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgZGVmZXIucmVzb2x2ZShkYXRhLnBob3Rvcy5waG90byk7XG4gICAgICB9KVxuICAgICAgLmVycm9yKGZ1bmN0aW9uKGVycm9yLCBzdGF0dXMpIHtcbiAgICAgICAgY29uc29sZS5sb2coZXJyb3IpO1xuICAgICAgICBkZWZlci5yZWplY3QoZXJyb3IpO1xuICAgICAgfSk7XG5cbiAgICAgIHJldHVybiBkZWZlci5wcm9taXNlO1xuXG4gICAgfVxuXG5cbiAgfVxuXG59KSgpO1xuIiwiKGZ1bmN0aW9uKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgYW5ndWxhci5tb2R1bGUoJ2RpZmZyLnNlcnZpY2VzJykuc2VydmljZSgnTG9jYWxTdG9yYWdlU2VydmljZScsIExvY2FsU3RvcmFnZVNlcnZpY2UpO1xuXG4gIExvY2FsU3RvcmFnZVNlcnZpY2UuJGluamVjdCA9IFsnJHdpbmRvdyddO1xuXG4gIGZ1bmN0aW9uIExvY2FsU3RvcmFnZVNlcnZpY2UoJHdpbmRvdykge1xuXG4gICAgLy8gdmFyaWFibGVzXG5cbiAgICAvLyBtZXRob2RzXG4gICAgdGhpcy5zZXQgPSBzZXQ7XG4gICAgdGhpcy5nZXQgPSBnZXQ7XG4gICAgdGhpcy5zZXRPYmplY3QgPSBzZXRPYmplY3Q7XG4gICAgdGhpcy5nZXRPYmplY3QgPSBnZXRPYmplY3Q7XG5cbiAgICAvLyBpbml0aWF0b3JzXG5cblxuXG4gICAgZnVuY3Rpb24gc2V0KGtleSwgdmFsdWUpIHtcbiAgICBcdCR3aW5kb3cubG9jYWxTdG9yYWdlW2tleV0gPSB2YWx1ZTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBnZXQoa2V5LCBkZWZhdWx0VmFsdWUpIHtcbiAgICBcdHJldHVybiAkd2luZG93LmxvY2FsU3RvcmFnZVtrZXldIHx8IGRlZmF1bHRWYWx1ZTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzZXRPYmplY3Qoa2V5LCB2YWx1ZSkge1xuICAgICAgJHdpbmRvdy5sb2NhbFN0b3JhZ2Vba2V5XSA9IEpTT04uc3RyaW5naWZ5KHZhbHVlKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBnZXRPYmplY3Qoa2V5KSB7XG4gICAgICByZXR1cm4gSlNPTi5wYXJzZSgkd2luZG93LmxvY2FsU3RvcmFnZVtrZXldIHx8ICd7fScpO1xuICAgIH1cblxuICB9XG5cbn0pKCk7XG4iLCIoZnVuY3Rpb24oKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICBhbmd1bGFyLm1vZHVsZSgnZGlmZnIuc2VydmljZXMnKS5zZXJ2aWNlKCdTdG9yYWdlU2VydmljZScsIFN0b3JhZ2VTZXJ2aWNlKTtcblxuICBTdG9yYWdlU2VydmljZS4kaW5qZWN0ID0gW107XG5cbiAgZnVuY3Rpb24gU3RvcmFnZVNlcnZpY2UoKSB7XG5cbiAgICAvLyB2YXJpYWJsZXNcbiAgICB2YXIgc3RvcmFnZU9iamVjdCAgICAgID0ge307XG4gICAgc3RvcmFnZU9iamVjdC5vYmplY3RzICA9IHt9O1xuICAgIHN0b3JhZ2VPYmplY3QuYXJyYXlzICAgPSB7fTtcbiAgICBzdG9yYWdlT2JqZWN0LnN0cmluZ3MgID0ge307XG5cbiAgICAvLyBtZXRob2RzXG4gICAgdGhpcy5zZXRPYmplY3QgICAgID0gc2V0T2JqZWN0O1xuICAgIHRoaXMuZ2V0T2JqZWN0ICAgICA9IGdldE9iamVjdDtcbiAgICB0aGlzLnNldEFycmF5ICAgICAgPSBzZXRBcnJheTtcbiAgICB0aGlzLmdldEFycmF5ICAgICAgPSBnZXRBcnJheTtcbiAgICB0aGlzLnNldFN0cmluZyAgICAgPSBzZXRTdHJpbmc7XG4gICAgdGhpcy5nZXRTdHJpbmcgICAgID0gZ2V0U3RyaW5nO1xuICAgIHRoaXMuZ2V0QWxsU3RvcmFnZSA9IGdldEFsbFN0b3JhZ2U7XG5cbiAgICAvLyBpbml0aWF0b3JzXG5cblxuXG4gICAgZnVuY3Rpb24gc2V0T2JqZWN0KGtleSwgdmFsdWUpIHtcbiAgICAgIHN0b3JhZ2VPYmplY3Qub2JqZWN0c1trZXldID0gdmFsdWU7XG5cdFx0fVxuXG5cdFx0ZnVuY3Rpb24gZ2V0T2JqZWN0KGtleSkge1xuXHRcdFx0cmV0dXJuIHN0b3JhZ2VPYmplY3Qub2JqZWN0c1trZXldO1xuXHRcdH1cblxuICAgIGZ1bmN0aW9uIHNldEFycmF5KGtleSwgdmFsdWUpIHtcbiAgICAgIHN0b3JhZ2VPYmplY3QuYXJyYXlzW2tleV0gPSB2YWx1ZTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBnZXRBcnJheShrZXkpIHtcbiAgICAgIHJldHVybiBzdG9yYWdlT2JqZWN0LmFycmF5c1trZXldO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHNldFN0cmluZyhrZXksIHZhbHVlKSB7XG4gICAgICBzdG9yYWdlT2JqZWN0LnN0cmluZ3Nba2V5XSA9IHZhbHVlO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGdldFN0cmluZyhrZXkpIHtcbiAgICAgIHJldHVybiBzdG9yYWdlT2JqZWN0LnN0cmluZ3Nba2V5XTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBnZXRBbGxTdG9yYWdlKCkge1xuICAgICAgcmV0dXJuIHN0b3JhZ2VPYmplY3Q7XG4gICAgfVxuXG4gIH1cblxufSkoKTtcbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==